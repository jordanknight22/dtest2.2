{% load custom_tags %}

<a href="/rates">
    <h1>Back</h1>
</a>

<hr>

<table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">
    <thead>
        <tr>
            <th>Pet Type</th>
            {% for pet_type, schemes in nested_rates.items %}
                <th colspan="{{ schemes|length }}">{{ pet_type|capfirst }}</th>
            {% endfor %}
        </tr>

        <tr>
            <th>Scheme</th>
            {% for pet_type, schemes in nested_rates.items %}
                {% for scheme, factors in schemes.items %}
                    <th>{{ scheme|capfirst|cut:"_" }}</th>
                {% endfor %}
            {% endfor %}
        </tr>

        <tr>
            <th>Limit</th>
            {% for pet_type, schemes in nested_rates.items %}
                {% for scheme, factors in schemes.items %}
                    <td>{{ factors|dict_key:"limit" }}</td>
                {% endfor %}
            {% endfor %}
        </tr>
    </thead>
        <tr>
            <th>Purchase Price</th>
        </tr>
    <tbody>
        {% for band in price_bands %}
        <tr>
            <th>{{ band }}</th>
            {% for pet_type, schemes in nested_rates.items %}
                {% for scheme, factors in schemes.items %}
                    <td>{{ factors|dict_key:"pet_price"|dict_key:band|floatformat:3 }}</td>
                {% endfor %}
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
